// https://leetcode.com/problems/cutting-ribbons/
// Medium

// max_element is slow: https://stackoverflow.com/questions/25622109/why-is-c-stdmax-element-so-slow
class Solution {
public:
    int maxLength(vector<int>& ribbons, int k) {
        int low = 1, high = *std::max_element(ribbons.begin(), ribbons.end());
        int max = 0;
        for (int mid = low + (high-low)/2; low <= high; mid = low + (high-low)/2) {
            int remaining = k;
            for (int ribbon : ribbons) {
                remaining -= ribbon / mid;
            }
            if (remaining <= 0) {
                max = mid;
                low = mid + 1;
            } else {
                high = mid - 1;
            }
        }
        return max;
    }
};

class ImprovedSolution {
public:
    int maxLength(vector<int>& ribbons, int k) {
        int low = 1, high = std::accumulate(ribbons.begin(), ribbons.end(), long(0)) / k;
        int max = 0;
        for (int mid = low + (high-low)/2; low <= high; mid = low + (high-low)/2) {
            int remaining = k;
            for (int ribbon : ribbons) {
                remaining -= ribbon / mid;
            }
            if (remaining <= 0) {
                max = mid;
                low = mid + 1;
            } else {
                high = mid - 1;
            }
        }
        return max;
    }
};

/*
Test data:
[7,5,9]
4
[5,7,9]
22
[9,7,5]
3
[100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,1,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000,100000]
49
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,100000,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
50
[19395,74951,78457,28775,4220,74417,93780,17136,48909,62794,63677,92205,12583,87520,79561,78971,57976,61587,75157,50591,28636,14027,15529,1641,70450,32087,35037,92085,98781,85208,17142,31444,6956,96775,35245,88454,44865,77779,26825,25744,5539,31036,4111,11932,30111,18656,11446,25451,52986,52575,97030,89016,68278,59139,93934,65743,1639,74173,51385,55046,49249,57296,829,61218,52692,3757,37763,25236,96489,8820,55551,50510,33968,44471,40221,60252,54165,86324,64617,83481,97478,70626,95989,7374,21424,59079,99323,19114,21138,15444,78724,31990,91391,66876,56097,54681,66381,39639,12157,78054,58657,20930,33001,24938,67567,78009,50465,81026,1107,10383,93080,97734,53674,35317,79228,84583,87874,5714,41454,14797,77078,5562,62414,36797,39415,61626,10184,67282,5440,38664,987,88667,46109,25088,18378,34959,38934,73211,73008,5634,83359,87519,86439,61209,26882,27463,68229,16906,32589,50913,49721,67768,94004,23083,47131,25083,43214,25010,98752,14520,72056,64046,25314,23878,31834,14061,49311,17183,49574,23408,14046,13706,43823,14673,23595,4583,62362,88224,31428,12064,58550,12419,58503,70455,75970,23172,60661,32576,49633,21883,45485,2813,50364,39750,8904,5434,54846,97063,34431,62824,35907,89679,28382,48702,98409,50170,41647,55379,15117,87449,8655,90349,16849,52520,21165,36466,24779,3370,80516,12532,13438,57666,30701,65392,14787,93157,32479,22751,63908,52337,45200,85034,75185,25739,54825,79268,66111,16128,68611,76330,12941,67946,52989,68443,5333,21037,49092,65220,38527,20597,71430,38941,71498,1628,48737,95313,99075,33786,7234,19791,31815,50473,12252,65491,68865,2871,14764,97827,50514,59276,84063,50376,94000,87745,5135,17671,41681,59314,66316,46742,89980,90219,86260,94786,42562,83227,71888,83836,93462,92734,38111,79960,34921,58974,29328,66336,19568,60541,74661,62132,52447,71426,72857,31113,59139,2041,25103,22844,25123,11175,80731,45114,37207,26536,39909,81013,49854,43742,73268,79209,49087,34439,56264,97046,60444,39256,94581,10811,5206,77313,30497,2403,65982,64626,53245,87293,17392,56548,72301,62811,14181,15852,4946,44471,61933,11377,4176,91984,50650,88296,58962,55622,58819,34266,24157,78142,57963,88517,86857,25050,60576,25935,65666,344,32253,14298,42763,53087,86207,94647,70621,83966,20256,3052,89303,40090,85900,84693,71346,63751,46366,56974,93086,43290,48042,2445,6440,71341,41557,73173,93526,51749,96974,69969,50240,2945,87260,8544,75632,67113,20595,91806,29965,74905,7923,94872,12963,83580,49577,71793,78527,58874,69060,6455,34473,71800,21250,30719,77652,55576,73707,20839,12852,80550,86233,54161,300,46875,81379,23109,72100,2604,61516,23710,40942,12882,57386,64690,7445,72900,14038,83678,22990,26600,17494,61511,45395,40275,85833,84481,75212,91863,84870,1070,20018,12561,40716,9243,37912,87141,23408,79692,47619,38364,73143,8328,25195,61382,73434,51924,8705,2903,70031,75715,55686,91168,29292,74479,9792,82488,50290,66214,73958,92317,5396,40968,71837,39042,34864,99871,33696,29388,49319,44034,56527,65325,23469,18081,66236,15735,70676,77140,78005,67403,36328,15964,97844,4213,72502,46188,49462,71533,31752,34522,89132,23153,23014,293,90418,50562,31395,66276,21402,52221,74174,51639,28184,66746,1944,78058,64588,21682,83215,6649,72911,93874,79526,7459,29416,9603,6734,57853,53880,76656,34606,83480,42125,98994,23909,62629,80409,81814,17493,30741,85414,82801,32087,27791,89214,64512,88819,38692,70841,35081,53750,62536,28215,64755,51362,92319,77727,22812,41414,35704,88694,83871,24969,69532,42653,52969,20567,91776,52279,14337,19158,75524,86083,16025,11068,85712,20754,98612,43618,26479,76699,35051,90942,28534,95538,47326,26146,78491,82602,31942,76258,96434,18126,13420,83302,34592,82971,33623,46885,93671,37634,42919,93682,48320,70716,42955,37279,8902,16503,24511,78058,71304,68391,22150,12378,32612,80070,12361,46416,84981]
844
*/
